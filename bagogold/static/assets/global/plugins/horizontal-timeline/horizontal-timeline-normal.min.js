function timeline(){function e(e,t,n){var i=p(e.eventsWrapper),a=Number(e.timelineWrapper.css("width").replace("px",""));"next"==n?r(e,i-a+u,a-t):r(e,i+a-u)}function t(e,t,i){var r=e.eventsContent.find(".selected");if(("next"==i?r.next():r.prev()).length>0){var l=e.eventsWrapper.find(".selected"),s="next"==i?l.parent("li").next("li").children("a"):l.parent("li").prev("li").children("a");a(s,e.fillingLine,t),o(s,e.eventsContent),s.addClass("selected"),l.removeClass("selected"),f(s),n(i,s,e)}}function n(e,t,n){var i=window.getComputedStyle(t.get(0),null),a=Number(i.getPropertyValue("left").replace("px","")),l=Number(n.timelineWrapper.css("width").replace("px","")),s=Number(n.eventsWrapper.css("width").replace("px","")),o=p(n.eventsWrapper);("next"==e&&a>l-o||"prev"==e&&a<-o)&&r(n,l/2-a,l-s)}function r(e,t,n){var i=e.eventsWrapper.get(0);t=t>0?0:t,d(i,"translateX",(t=void 0!==n&&t<n?n:t)+"px"),0==t?e.timelineNavigation.find(".prev").addClass("inactive"):e.timelineNavigation.find(".prev").removeClass("inactive"),t==n?e.timelineNavigation.find(".next").addClass("inactive"):e.timelineNavigation.find(".next").removeClass("inactive")}function a(e,t,n){var i=window.getComputedStyle(e.get(0),null),r=i.getPropertyValue("left"),a=i.getPropertyValue("width"),l=(r=Number(r.replace("px",""))+Number(a.replace("px",""))/2)/n;d(t.get(0),"scaleX",l)}function l(e,t){var n=2*e.timelineDates.length*t,r=Math.max(n,e.timelineNavigation.find(".next").position().left);for(i=0;i<e.timelineDates.length;i++){var a=2*i*r/n;e.timelineEvents.eq(i).css("left",a*t+"px")}}function s(e,t){var i=2*e.timelineDates.length,r=Math.max(i*t,e.timelineNavigation.find(".next").position().left);return e.eventsWrapper.css("width",r+"px"),a(e.eventsWrapper.find("a.selected"),e.fillingLine,r),n("next",e.eventsWrapper.find("a.selected"),e),r}function o(e,t){var n=e.data("date"),i=t.find(".selected"),r=t.find('[data-date="'+n+'"]'),a=r.height();if(r.index()>i.index())var l="selected enter-right",s="leave-left";else var l="selected enter-left",s="leave-right";r.attr("class",l),i.attr("class",s).one("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){i.removeClass("leave-right leave-left"),r.removeClass("enter-left enter-right")}),t.css("height",a+"px")}function f(e){e.parent("li").prevAll("li").children("a").addClass("older-event").end().end().nextAll("li").children("a").removeClass("older-event")}function p(e){var t=window.getComputedStyle(e.get(0),null),n=t.getPropertyValue("-webkit-transform")||t.getPropertyValue("-moz-transform")||t.getPropertyValue("-ms-transform")||t.getPropertyValue("-o-transform")||t.getPropertyValue("transform");if(n.indexOf("(")>=0)i=(n=(n=(n=n.split("(")[1]).split(")")[0]).split(","))[4];else var i=0;return Number(i)}function d(e,t,n){e.style["-webkit-transform"]=t+"("+n+")",e.style["-moz-transform"]=t+"("+n+")",e.style["-ms-transform"]=t+"("+n+")",e.style["-o-transform"]=t+"("+n+")",e.style.transform=t+"("+n+")"}function v(e){var t=[];return e.each(function(){var e=$(this).data("date").split("T");if(e.length>1)var n=e[0].split("/"),i=e[1].split(":");else if(e[0].indexOf(":")>=0)var n=["2000","0","0"],i=e[0].split(":");else var n=e[0].split("/"),i=["0","0"];var r=new Date(n[2],n[1]-1,n[0],i[0],i[1]);t.push(r)}),t}function c(e){for(var t=e.offsetTop,n=e.offsetLeft,i=e.offsetWidth,r=e.offsetHeight;e.offsetParent;)t+=(e=e.offsetParent).offsetTop,n+=e.offsetLeft;return t<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&t+r>window.pageYOffset&&n+i>window.pageXOffset}function m(){return window.getComputedStyle(document.querySelector(".cd-horizontal-timeline"),"::before").getPropertyValue("content").replace(/'/g,"").replace(/"/g,"")}var u,g=$(".cd-horizontal-timeline");g.length>0&&g.each(function(){u=$(this).data("spacing");var n=$(this),i={};i.timelineWrapper=n.find(".events-wrapper"),i.eventsWrapper=i.timelineWrapper.children(".events"),i.fillingLine=i.eventsWrapper.children(".filling-line"),i.timelineEvents=i.eventsWrapper.find("a"),i.timelineDates=v(i.timelineEvents),i.timelineNavigation=n.find(".cd-timeline-navigation"),i.eventsContent=n.children(".events-content"),l(i,u);var r=s(i,u);n.addClass("loaded"),i.timelineNavigation.on("click",".next",function(t){t.preventDefault(),e(i,r,"next")}),i.timelineNavigation.on("click",".prev",function(t){t.preventDefault(),e(i,r,"prev")}),i.eventsWrapper.on("click","a",function(e){e.preventDefault(),i.timelineEvents.removeClass("selected"),$(this).addClass("selected"),f($(this)),a($(this),i.fillingLine,r),o($(this),i.eventsContent)}),i.eventsContent.on("swipeleft",function(){"mobile"==m()&&t(i,r,"next")}),i.eventsContent.on("swiperight",function(){"mobile"==m()&&t(i,r,"prev")}),$(document).keyup(function(e){"37"==e.which&&c(n.get(0))?t(i,r,"prev"):"39"==e.which&&c(n.get(0))&&t(i,r,"next")})})}