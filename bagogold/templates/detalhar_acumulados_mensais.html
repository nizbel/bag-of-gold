{% extends "base.html" %}
{% load staticfiles %}

{% block pagina_titulo_icone %}
<i class="icon-user font-yellow-crusta"></i>
{% endblock %}

{% block content %}
<div class="portlet-body">
	<div class="row">
		<div class="col-md-4">
			<!-- BEGIN Portlet PORTLET-->
			<div class="portlet box yellow-crusta">
				<div class="portlet-title">
					<div class="caption">
						<i class="fa fa-clock-o"></i>Acumulado mensal nos últimos 12 meses</div>
					<div class="tools">
						<a href="javascript:;" class="collapse"></a>
					</div>
				</div>
				<div class="portlet-body">
					<div class="list-group">
						{% for periodo, acumulado in periodos %}
						<span class="list-group-item">{{periodo}}: R$ {{acumulado|floatformat:'2'}}</span>
						{% endfor %}
					</div>
				</div>
			</div>
			<!-- END Portlet PORTLET-->
		</div>
			</div>
		</div>
	</div>
</div>

{% endblock %}

{% block extra_footer %}
<script src={% static "assets/global/plugins/counterup/jquery.waypoints.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/counterup/jquery.counterup.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/jquery.pulsate.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/flot/jquery.flot.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/flot/jquery.flot.resize.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/flot/jquery.flot.categories.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/flot/jquery.flot.stack.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/flot/jquery.flot.crosshair.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/flot/jquery.flot.axislabels.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/flot/jquery.flot.time.min.js" %} type="text/javascript"></script>
<script>
$( document ).ready(function() {
    $.plot($("#graf_rendimentos_mensal"), [ {color: "#33AA33", label: "Letras de Crédito", bars: {show:true, align:"center", barWidth: 24 * 60 * 60 * 100, lineWidth: 1, stacked: false}, data: {{ graf_rendimentos_mensal_lc|safe }} }, 
                                           {color: "#8811AA", label: "CDB/RDB", bars: {show:true, align:"center", barWidth: 24 * 60 * 60 * 100, lineWidth: 1, stacked: false}, data: {{ graf_rendimentos_mensal_cdb_rdb|safe }} },
                                           {color: "#AABB33", label: "Tesouro Direto", bars: {show:true, align:"center", barWidth: 24 * 60 * 60 * 100, lineWidth: 1, stacked: false}, data: {{ graf_rendimentos_mensal_td|safe }} },
                                           {color: "#FF1100", label: "Debêntures", bars: {show:true, align:"center", barWidth: 24 * 60 * 60 * 100, lineWidth: 1, stacked: false}, data: {{ graf_rendimentos_mensal_debentures|safe }} },
                                           {color: "#222222", label: "CRI/CRA", bars: {show:true, align:"center", barWidth: 24 * 60 * 60 * 100, lineWidth: 1, stacked: false}, data: {{ graf_rendimentos_mensal_cri_cra|safe }} },
                                      ],
                                        {grid: { hoverable: true}, legend:{position:"nw"}, xaxis: {mode: "time",timeformat: "%d/%m"},
                                        } 
    );
    
function showTooltip(x, y, contents) {
        
        $('<div id="tooltip">' + contents + '</div>').css( {
            position: 'absolute',
            display: 'none',
            top: y + 5,
            left: x + 5,
            border: '1px solid #fdd',
            padding: '2px',
            'background-color': '#fee',
            opacity: 0.80
        }).appendTo("body").fadeIn(200);
    }

    var previousPoint = null;
    $("#graf_rendimentos_mensal").bind("plothover", function (event, pos, item) {
        $("#x").text(pos.x.toFixed(2));
        $("#y").text(pos.y.toFixed(2));

        if (item) {
            if (previousPoint != item.datapoint) {
                previousPoint = item.datapoint;
                
                $("#tooltip").remove();
                var x = item.datapoint[0].toFixed(2),
                    y = String(item.datapoint[1].toFixed(2)).replace('.', ',');
                
                var date = new Date(parseInt(x));
                showTooltip(item.pageX, item.pageY, $.plot.formatDate(date, "%d/%m/%y") +"</br>" + item.series.label + ": R$" + y);
            }
        }
        else {
            $("#tooltip").remove();
            clicksYet = false;
            previousPoint = null;            
        }
    });
});
</script>
{% endblock %}