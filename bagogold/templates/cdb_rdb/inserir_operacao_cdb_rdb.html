{% extends "teste/base.html" %}
{% load staticfiles %}

{% block extra_head %}
<link href={% static "assets/global/plugins/bootstrap-select/css/bootstrap-select.min.css" %} rel="stylesheet" type="text/css" />
<link href={% static "assets/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" %} rel="stylesheet" type="text/css" />
<link href={% static "assets/global/plugins/bootstrap-datetimepicker/css/bootstrap-datetimepicker.min.css" %} rel="stylesheet" type="text/css" />
{% endblock %}

{% block content %}

<div class="row">
    <div class="col-md-12">
		<div class="portlet light">
			<div class="portlet-title">
				<div class="caption font-yellow-crusta">
					<i class="icon-plus font-yellow-crusta"></i>
					<span class="caption-subject bold uppercase"> Inserir operação em CDB/RDB </span>
				</div>
			</div>
			<div class="portlet-body form">
				<!-- BEGIN FORM-->
				<form method="POST" class="horizontal-form">{% csrf_token %}
					<div class="form-body">
						<div class="row">
							<div class="form-group col-md-6 {% if form_operacao_cdb_rdb.tipo_operacao.errors %} has-error {% endif %}">
								<label class="control-label col-md-4" style="text-align: left;"> Tipo de operação: </label>
								<div class="col-md-8">
									<select class="selectpicker form-control" id="id_tipo" name="tipo">
										{% for key, value in form_operacao_cdb_rdb.fields.tipo_operacao.widget.choices %}<option value="{{ key }}">{{ value }}</option>{% endfor %}
									</select>
									{% if form_operacao_cdb_rdb.tipo_operacao.errors %} <span class="help-block"> {{ form_operacao_cdb_rdb.tipo_operacao.errors.as_text }} </span> {% endif %}
								</div>
							</div>
							<div class="form-group col-md-6 {% if form_operacao_cdb_rdb.quantidade.errors %} has-error {% endif %}">
								<label class="control-label col-md-4"  style="text-align: left;"> Quantidade investida/resgatada: </label>
								<div class="col-md-8">
									<input id="id_quantidade" type="text" value="0" name="quantidade" class="form-control">
									{% if form_operacao_cdb_rdb.quantidade.errors %} <span class="help-block"> {{ form_operacao_cdb_rdb.quantidade.errors.as_text }} </span> {% endif %}
								</div>
							</div>
						</div>
						<div class="row">
							<div class="form-group col-md-6 {% if form_operacao_cdb_rdb.data.errors %} has-error {% endif %}">
								<label class="control-label col-md-4" style="text-align: left;"> Data da operação: </label>
								<div class="col-md-8">
									<div class="input-group input-medium date date-picker {% if not form_operacao_cdb_rdb.data.value %} disabled {% endif %}" data-date-format="dd/mm/yyyy" id="id_data" name="data" data-date="{{form_operacao_cdb_rdb.data.value|default:""}}" data-date-viewmode="years">
										<input type="text" class="form-control">
										<span class="input-group-btn">
											<button class="btn default" type="button">
												<i class="fa fa-calendar"></i>
											</button>
										</span>
									</div>
									<span class="help-block"> Selecione uma data </span>
								</div>
							</div>
							<div class="form-group col-md-6 {% if form_operacao_cdb_rdb.investimento.errors %} has-error {% endif %}">
								<label class="control-label col-md-4" style="text-align: left;"> Investimento: </label>
								<div class="col-md-8">
									<select class="selectpicker form-control" id="id_investimento" name="investimento">
										{% for key, value in form_operacao_cdb_rdb.fields.investimento.widget.choices %}<option value="{{ key }}">{{ value }}</option>{% endfor %}
									</select>
									{% if form_operacao_cdb_rdb.investimento.errors %} <span class="help-block"> {{ form_operacao_cdb_rdb.investimento.errors.as_text }} </span> {% endif %}
								</div>
							</div>
						</div>
						{% if varias_divisoes %}
							<h2 class="font-yellow-crusta" align="center">
							<strong>Divisões</strong> <button id="add-another" class="btn btn-icon-only green-steel" type="button"><i class="fa fa-plus"></i></button>
							</h2>
							{{ formset_divisao_cdb_rdb.management_form }}
							{% for form_divisao in formset_divisao_cdb_rdb %}
							<h3 class="font-yellow-crusta" align="center"><strong>Divisão {{ forloop.counter }}</strong></h3>
							<br/>
							<div class="row">
								<div class="form-group col-md-6 {% if form_divisao.divisao.errors %} has-error {% endif %}">
									<label class="control-label col-md-4" style="text-align: left;"> Divisão: </label>
									<div class="col-md-8">
										<select class="selectpicker form-control" id="id_divisaooperacaocdb_rdb_set-{{forloop.counter0}}-divisao" name="divisaooperacaocdb_rdb_set-{{forloop.counter0}}-divisao">
											{% for key, value in form_divisao.fields.divisao.widget.choices %}<option value="{{ key }}">{{ value }}</option>{% endfor %}
										</select>
										{% if form_divisao.divisao.errors %} <span class="help-block"> {{ form_divisao.divisao.errors.as_text }} </span> {% endif %}
									</div>
								</div>
								<div class="form-group col-md-6 {% if form_divisao.quantidade.errors %} has-error {% endif %}">
									<label class="control-label col-md-4"> Quantidade: </label>
									<div class="col-md-8">
										<input id="id_divisaooperacaocdb_rdb_set-{{forloop.counter0}}-quantidade" type="text" value="{{form_divisao.quantidade.value}}" name="divisaooperacaocdb_rdb_set-{{forloop.counter0}}-quantidade" class="form-control">
										{% if form_divisao.quantidade.errors %} <span class="help-block"> {{ form_divisao.quantidade.errors.as_text }} </span> {% endif %}
									</div>
								</div>
							</div>
							{% endfor %}
						{% endif %}
						<div class="form-actions">
							<div class="row">
								<div class="col-md-offset col-md-3">
									<button type="submit" name="save" value="1" class="btn green-steel">Salvar</button>
								</div>
							</div>
						</div>
					</div>
				</form>
				<!-- END FORM-->
			</div>
		</div>
	</div>
</div>

{% endblock %}

{% block extra_footer %}
<script src={% static "assets/global/plugins/fuelux/js/spinner.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/bootstrap-touchspin/bootstrap.touchspin.js" %} type="text/javascript"></script>
<script src={% static "assets/pages/scripts/components-bootstrap-touchspin.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/jquery-validation/js/jquery.validate.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/jquery-validation/js/additional-methods.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/bootstrap-select/js/bootstrap-select.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/moment.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js" %} type="text/javascript"></script>
<script src={% static "assets/global/plugins/bootstrap-datepicker/locales/bootstrap-datepicker.pt-BR.min.js" %} type="text/javascript"></script>
{{ form_operacao_cdb_rdb.media }}
<script>
$(document).ready(function() {
	$("input[name='quantidade']").TouchSpin({
        initval: 0.01,
		min: 0.01,
		max: 999999999,
        step: 0.01,
        decimals: 2,
		maxboostedstep: 100,
        prefix: 'R$'
	});
	$("input[name='divisaooperacaocdb_rdb_set-0-quantidade']").TouchSpin({
		min: 0,
		max: 1000000000,
		step: 0.01,
		decimals: 2,
		maxboostedstep: 100,
		prefix: 'R$'
	});
	$('.date-picker').datepicker({
	   language: 'pt-BR'
	});
    $("select[id$='-divisao']").selectpicker('refresh');
});
</script>
{% endblock %}